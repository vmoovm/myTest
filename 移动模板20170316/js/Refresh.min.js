function PushRefresh(a,c){this.zconf={backSite:-30,swipeDist:40,refreshTime:2000,swipeAngle:60,isStopDown:false,pushDownTxt:"下拉刷新",releaseTxt:"释放刷新",pushDownLoadingTxt:"正在刷新...",scroll:null};this.zconf.onRefreshStart=function(){};this.zconf.onRefreshEnd=function(){};this.refreshId=document.querySelector(a);this.zconf.site={startX:0,startY:0,endX:0,endY:0,moveX:0,moveY:0,pushLen:0};for(v in this.zconf){for(b in c){if(v==b){this.zconf[v]=c[b]}}}this.createRefresh(this.zconf);this.pushUpLoading=function(){}}PushRefresh.prototype.createRefresh=function(j){var k=this;var a=j.scroll?document.querySelector(j.scroll):null;var n=a||window;var o=a?a.scrollTop:(document.documentElement.scrollTop||document.body.scrollTop);var d=false;var m=document.createElement("div");m.className="zrefresh",m.id="pushDown";var i=document.createElement("p");i.className="refreshing",i.id="pushState";var p=document.createElement("p");p.className="refresh_text",p.id="pushTxt";m.appendChild(i);m.appendChild(p);p.innerHTML=j.pushDownTxt;
k.refreshId.parentNode.insertBefore(m,k.refreshId);var c=function(q){m.classList.remove("zanimate");j.site.startX=q.targetTouches[0].pageX;j.site.startY=q.targetTouches[0].pageY};var f=function(s){j.site.endX=s.targetTouches[0].pageX;j.site.endY=s.targetTouches[0].pageY;j.site.moveX=j.site.endX-j.site.startX,j.site.moveY=j.site.endY-j.site.startY;if(j.site.moveY<=0||j.site.startY==0){d=false;m.style.marginTop=j.backSite+"px";return false}if(j.site.moveY>2&&!j.isStopDown){s.preventDefault();var r=0,q=0,u=0,t=0;r=Math.abs(j.site.moveY);q=Math.abs(j.site.moveX);u=Math.sqrt(Math.pow(r,2)+Math.pow(q,2));t=Math.floor(180*Math.asin(q/u)/Math.PI);if(t<j.swipeAngle){j.site.pushLen=j.site.moveY*0.7;m.style.marginTop=(j.backSite+j.site.pushLen)+"px";if(j.site.pushLen>j.swipeDist){p.innerHTML=j.releaseTxt;d=true}else{p.innerHTML=j.pushDownTxt}}}};var h=function(){m.style.marginTop=j.site.pushLen+"px";p.innerHTML=j.pushDownTxt;i.classList.remove("zrunning");e();j.onRefreshEnd(k)};var l=function(){g();
if(d&&j.site.pushLen>j.swipeDist){m.classList.add("zanimate");m.style.marginTop=4+"px";p.innerHTML=j.pushDownLoadingTxt;i.classList.add("zrunning");j.onRefreshStart(k);d=false}else{m.classList.add("zanimate");m.style.marginTop=j.backSite+"px";p.innerHTML=j.pushDownTxt;i.classList.remove("zrunning");e();return false}j.site.pushLen=j.backSite;setTimeout(function(){h()},j.refreshTime)};function e(){k.refreshId.addEventListener("touchstart",c,false);k.refreshId.addEventListener("touchmove",f,false);k.refreshId.addEventListener("touchend",l,false)}function g(){k.refreshId.removeEventListener("touchstart",c);k.refreshId.removeEventListener("touchmove",f);k.refreshId.removeEventListener("touchend",l)}if(!(j.sTop>0)&&!j.isStopDown){e()}else{g()}n.addEventListener("scroll",function(){o=a?a.scrollTop:(document.documentElement.scrollTop||document.body.scrollTop);if(o<=0&&!j.isStopDown){e()}else{g()}},false)};function PushUp(c,a){this.zconf={isStopUp:false,loadingTxt:"加载中...",pushUpTxt:"上滑加载更多",warnningTxt:"没有更多",isData:true,scroll:null};
this.zconf.Dataloading=function(){};this.PushUpId=document.querySelector(c);this.zconf=Object.assign(this.zconf,a);this.eleScroll=this.zconf.scroll?document.querySelector(this.zconf.scroll):null;this.sTop=this.eleScroll?this.eleScroll.scrollTop:(document.documentElement.scrollTop||document.body.scrollTop);this.zheight=document.documentElement.clientHeight;this.refreshUp=document.createElement("div");this.refreshUp.className="zrefresh",this.refreshUp.id="refreshUp";this.refreshState=document.createElement("p");this.refreshState.className="refreshing",this.refreshState.id="refreshState";this.refreshTxt=document.createElement("p");this.refreshTxt.className="refresh_text",this.refreshTxt.id="refreshTxt";this.refreshUp.appendChild(this.refreshState);this.refreshUp.appendChild(this.refreshTxt);this.refreshTxt.innerHTML=this.zconf.loadingTxt;this.pushUpInit(this.zconf)}PushUp.prototype.pushUpInit=function(d){var c=this;var a=this.eleScroll||window;a.onscroll=function(){c.sTop=c.eleScroll?c.eleScroll.scrollTop:(document.documentElement.scrollTop||document.body.scrollTop);
var f=c.sTop+c.zheight;var e=c.eleScroll?c.eleScroll.scrollHeight:(document.documentElement.scrollHeight||document.body.scrollHeight);if(f==e&&!d.isStopUp){d.isStopUp=true;d.Dataloading(c);c.PushUpId.parentNode.appendChild(c.refreshUp,c.PushUpId);c.refreshState.classList.add("zrunning")}else{}}};PushUp.prototype.ChangeState=function(){if(this.isData){document.querySelector("#refreshUp").remove();this.zconf.isStopUp=false}else{document.querySelector("#refreshTxt").innerHTML=this.zconf.warnningTxt;document.querySelector("#refreshState").style.display="none"}};